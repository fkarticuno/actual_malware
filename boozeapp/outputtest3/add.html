<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Star Wars - Express</title>
  <!-- Latest compiled and minified CSS & JS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <script src="https://code.jquery.com/jquery.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
<style>
  img {
    height: 200px;
    width: 200px;
  }
  </style>
</head>
<body>

  <div class="container">
    <div class="jumbotron">
      <h1>Star Wars Express</h1>
      <h3>The greatest resource in the galaxy for Star Wars statistics!</h3>
      <hr>
      <a href="/"><button class="btn btn-danger btn-lg"><span class="fa fa-eye"></span> View Characters</button></a>
    </div>
    <div class="row">

      <div class="col-12">

        <div class="card">
          <div class="card-header">
            <h3><strong>Add Characters</strong></h3>
          </div>
          <div class="card-body">
            <form method="POST" role="form">

              <div class="form-group">
                <label for="name">Name</label>
                <input type="text" class="form-control" id="name">
              </div>

              <div class="form-group">
                <label for="role">Role</label>
                <input type="text" class="form-control" id="role">
              </div>

              <div class="form-group">
                <label for="age">Age</label>
                <input type="text" class="form-control" id="age">
              </div>

              <div class="form-group">
                <label for="force-points">Force Points</label>
                <input type="text" class="form-control" id="force-points">
              </div>

            </form>
            <br>
            <div class="text-right">
              <button type="submit" class="btn btn-primary btn-md" id="add-btn"><span class="fa fa-fire"></span> Add to the Force</button>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <h1>
    DRINKS API TEST
</h1>
<p>
    Search Drinks By Name
</p>
<span>
    <input type="text" id="drink-input" value="Ice">
    <input id="search-drink" type="submit" value="Search by Drink Name">
    <span>
        ||||
    </span>
    <input id="search-ingredients" type="button" value="Search by Ingredients">
    <input type="text" id="ingredient-input" value="vodka">
</span>
<div class="wrap">
<div class="name">Name: Ice</div>
<div class="image"><img src="https://www.thecocktaildb.com/images/ingredients/ice-Medium.png" alt="" srcset=""></div>
<div class="glass">Glass</div>
<div class="infoA">Ingredient 1: Water</div>
<div class="infoB">
    <iframe id="video" width="560" height="315" src="https://www.youtube.com/embed/hi2k3ygVJ3g" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>

<div>
    <span class="type1"></span>
    <span class="type2"></span>
</div>
<div class="maxcp"></div>

</div>

<script src="https://ajax.googleapis.com/ajax/libs/ext-core/3.1.0/ext-core.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>    

<script>

//  Handles onClick to search for drinks
var ing = [];    // tracks ingredients to sort out null values
var mes = [];   // tracks measurements to sort out null values
var dSearch, settings, settingsI, drink, dName, newDrink;

$("#search-ingredients").on("click",function(event) {
dsearch = $("#ingredient-input").val().trim();
console.log("ingredient:",dsearch);
settingsI = {
    "async": true,
    "crossDomain": true,
    "url": "https://cors-anywhere.herokuapp.com/https://www.thecocktaildb.com/api/json/v1/1/filter.php?i=Gin",//+dSearch,
    "method": "GET",
    "headers": {
        "x-rapidapi-host": "the-cocktail-db.p.rapidapi.com",
        "x-rapidapi-key": "1bb40a3f2cmsh737e756f49ff562p1d4980jsn6537251a9bc1",
        "Access-Control-Allow-Origin": "*"  
  }
}
searchIngredients();
})
$("#search-drink").on("click", function(event) {
dSearch = $("#drink-input").val().trim();
settings = {
    "async": true,
    "crossDomain": true,
    "url": "https://cors-anywhere.herokuapp.com/https://www.thecocktaildb.com/api/json/v1/1/search.php?s="+dSearch,
    "method": "GET",
    "headers": {
        "x-rapidapi-host": "the-cocktail-db.p.rapidapi.com",
        "x-rapidapi-key": "1bb40a3f2cmsh737e756f49ff562p1d4980jsn6537251a9bc1",
        "Access-Control-Allow-Origin": "*"  
  }
}
searchDrinks();

var youtubeKey = "AIzaSyCeF_O5BoqvplkNVOWliaeeO436INp6juw";
settings = {
    "async": true,
  "crossDomain": true, //
    "url": "https://www.googleapis.com/youtube/v3/search?list&q=cat&key="+youtubeKey+
    "&part=snippet,contentDetails,statistics,status",
  "method": "GET"
    }       
searchVideo();
});
//  Handles API query for drink stats and forms url for drink image
function searchIngredients() {
$.ajax(settingsI).done(function (res) {
console.log("ingredient?:",res);             

});
};

function searchDrinks() {
$.ajax(settings).done(function (res) {
console.log("1",res);
console.log("2",res.drinks);
console.log("3",res.drinks[0].strDrink);
$(".infoA").text("");
drink = res.drinks[0];
dName = drink.strDrink;
//console.log("body:",res.body);    
$('.name').text(`Name: ${drink.strDrink}`);
$('.image').html(`<img src=${drink.strDrinkThumb}>`);
$('.glass').text(`Glass: ${drink.strGlass}`);
ing = [];    
mes = [];
ing.push(drink.strIngredient1,drink.strIngredient2,drink.strIngredient3,drink.strIngredient4,
    drink.strIngredient5,drink.strIngredient6,drink.strIngredient7,drink.strIngredient8,
    drink.strIngredient9,drink.strIngredient10,drink.strIngredient11,drink.strIngredient12,
    drink.strIngredient13,drink.strIngredient14,drink.strIngredient15
)
mes.push(drink.strMeasure1,drink.strMeasure2,drink.strMeasure3,drink.strMeasure4,
    drink.strMeasure5,drink.strMeasure6,drink.strMeasure7,drink.strMeasure8,
    drink.strMeasure9,drink.strMeasure10,drink.strMeasure11,drink.strMeasure12,
    drink.strMeasure13,drink.strMeasure14,drink.strMeasure15
)
    for (var i=0; i<ing.length;i++) {
        if (ing[i] != null) {
            $('.infoA').append(` ${i+1}: ${mes[i]} ${ing[i]}`)
            $('.infoA').append("<br>");
        } 
    }
$('.infoA').append("Instructions:", "<br>",drink.strInstructions)

  newDrink = {
        name: drink.strDrink,
        image: drink.strDrinkThumb,
        glass: mes,
        ingredients: drink.strInstructions
      };
  $.post("/api/allsearched", newDrink)
    .then(function(data) {
      console.log("add.html", data);
      alert("Adding drink...");
  });
});


function searchVideo() {
$.ajax(settings).done(function (res) {
console.log("youtube 1",res);
console.log("youtube 2",res.items[0].id)
$('#video').attr("src","https://www.youtube.com/embed/"+res.items[0].id)
})
};
//searchByKeyword();

// function searchByKeyword() {
//   var results = YouTube.Search.list('id,snippet', {q: 'dogs', maxResults: 5});
//   for(var i in results.items) {
//     var item = results.items[i];
//     Logger.log('[%s] Title: %s', item.id.videoId, item.snippet.title);
//   }
//   console.log(results)
// }

  //<script type="text/javascript">
    // Question: What does this code do?
    $("#add-btn").on("click", function(event) {
      event.preventDefault();
      var newCharacter = {
        name: $("#name").val().trim(),
        role: $("#role").val().trim(),
        age: $("#age").val().trim(),
        forcePoints: $("#force-points").val().trim()
      };
      // testcode

      // ========
      // Question: What does this code do??
      $.post("/api/characters", newCharacter)
        .then(function(data) {
          console.log("add.html", data);
          alert("Adding character...");
        });
    });
  </script>

</body>
</html>