var path = require("path");

var isAuthenticated = require("../config/middleware/isAuthenticated");

module.exports = function(app, db) {
    app.get("/", function(req, res) {
        if(req.user) {
            res.redirect("/profiles");
        }
        res.render("index")
    });

    app.get("/signup", function(req, res) {
        res.render("userCreate");
    });

    app.post("/signup", function(req, res, next) {
        
        db.User.create({
            username: req.body.username,
            password: req.body.password 
        })
        res.render("signupSuccess");
    });

    app.get("/profiles", isAuthenticated, function (req, res) {
        res.render("/profiles");
    });

    app.get("/signup/success", function(req, res) {
        res.render("signup-success");
    });

    app.get("/login", function(req, res) {
        res.render("login");
    });

    app.get("/random/favorite", function(req, res){
        res.render("random/favorite")
    });
    app.post("/random/favorite", function(req, res){
        db.Cocktails.create({
            drinkID: $('#name').attr('data'),
            cocktailName: $('#name').val(),
            cocktailInstructions: $('#instructions').val(),
            cocktailIngredients: $('#ingredients').val(),
            cocktailMeasurements: '', 
            cocktailFavorite: false,
            notes: ''
        })
        res.render("index.html"); // favorites page?
    });
    app.get("/api/signup", function(req, res) {
        res.render("userCreate");
    });

    app.get("/login", function(req, res) {
        if(req.user) {
            res.redirect("/profiles")
        }
    });

    app.get("/profiles", isAuthenticated, function(req, res) {
        res.render("/profiles");
    });
};